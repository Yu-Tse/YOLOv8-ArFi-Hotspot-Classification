# Hotspot Detection in ArFi Lithography Using Deep Learning

This repository contains code, photomask layout datasets, and results for predicting sub-50nm trench hotspots in ArF immersion (ArFi) lithography using machine learning, as presented in the PMJ2025 conference paper (Photomask Japan, SPIE).

---

## Background

ArF immersion lithography (193i) is a key technology for high-volume manufacturing of advanced semiconductors. However, aggressive scaling (low k‚ÇÅ factor, e.g., k‚ÇÅ=0.335 for 48nm CD) introduces *hotspots*‚Äîregions prone to CD variations and yield loss, even after standard DRC and OPC. Traditionally, mask revision is used to correct these hotspots, but the process is costly and time-consuming.

We leverage machine learning to **detect lithographic hotspots** from layout images, aiming to accelerate and automate the hotspot review process and reduce human error.

---

## Main Features

- **YOLOv8 Classification Head Modification**  
  The provided code customizes the YOLOv8 classification head to fit the hotspot binary classification task and trains it using an image dataset generated by Prolith simulations.

- **Automated Training & Evaluation**  
  Includes scripts for training, validation, and testing, with reproducible hyperparameters and a focus on robust model selection.

- **Data Augmentation Pipeline**  
  Incorporates domain-specific augmentations, such as morphological operations (dilation/erosion), FFT-based filtering, and CAD-based synthetic pattern generation.

- **Results**  
  Achieved ~80% accuracy and F1 score of 0.75 for YOLOv8; up to 0.92 F-score for EfficientNet-B7 with proper augmentations (see paper for details).

---

## Repository Contents

- [`code_YOLO-cls.py`](code_YOLO-cls.py):  
  Main PyTorch/Ultralytics script for customizing and training YOLOv8 for binary (hotspot) classification.

- [`data/`]:  
  Contains the image dataset of 140+ photomask layouts used for training, validation, and testing, with binary labels ("Good" or "NG").  
  All images are generated via Prolith lithography simulation, as detailed in the PMJ2025 paper.  
  *If you use or redistribute this dataset, please acknowledge the source and cite the original paper.*
---


## Dataset

This repository **includes the photomask layout images (dataset) generated by Prolith simulation** for hotspot classification research purposes.  
All layout images are labeled and divided into training, validation, and test sets.  
*Note: Results may vary if you use other datasets, or run on different hardware/software.*

---

## Experiment Reproducibility

**Note:** Experimental results may vary depending on hardware, software versions, and training environment.  
All experiments in this study were conducted on a system equipped with:

- **GPU:** NVIDIA RTX 4090  
- **CPU:** Intel i9-14900K

Reproducibility is best guaranteed by matching both hardware and Python dependencies as closely as possible.  
Please refer to the provided requirements and update them according to your own setup if necessary.

The author makes no guarantee of identical results across all environments.

---

## Quick Start

### Prerequisites

- Python 3.9+
- PyTorch
- [Ultralytics YOLO](https://github.com/ultralytics/ultralytics)

### Training

1. Update the `dataset_path` in `code_YOLO-cls.py` to your dataset directory.
2. Run:

```bash
python code_YOLO-cls.py
```
---
### üìù License

[MIT License](LICENSE)

---
## üôã‚Äç‚ôÇÔ∏è Author

**Yu-Tse Wu** (Âê≥Èõ®Êæ§)  
*Master‚Äôs Student at the Institute of Innovation and Semiconductor Manufacturing, National Sun Yat-sen University*

GitHub: [@Yu-Tse](https://github.com/Yu-Tse)
